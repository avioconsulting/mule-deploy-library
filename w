[1mdiff --git a/library/src/main/java/com/avioconsulting/mule/deployment/api/models/policies/ClientEnforcementPolicyCustomAuth.groovy b/library/src/main/java/com/avioconsulting/mule/deployment/api/models/policies/ClientEnforcementPolicyCustomAuth.groovy[m
[1mindex d8015b7..4ed6c95 100644[m
[1m--- a/library/src/main/java/com/avioconsulting/mule/deployment/api/models/policies/ClientEnforcementPolicyCustomAuth.groovy[m
[1m+++ b/library/src/main/java/com/avioconsulting/mule/deployment/api/models/policies/ClientEnforcementPolicyCustomAuth.groovy[m
[36m@@ -3,7 +3,7 @@[m [mpackage com.avioconsulting.mule.deployment.api.models.policies[m
 /**[m
  * Equivalent to "Custom Expression" in the GUI[m
  */[m
[31m-class ClientEnforcementPolicyCustom extends BaseClientEnforcementPolicy {[m
[32m+[m[32mclass ClientEnforcementPolicyCustomAuth extends BaseClientEnforcementPolicy {[m
     /**[m
      * Build a new policy[m
      * @param policyPathApplications List of policy path apps. By default, will apply to all paths[m
[36m@@ -11,10 +11,11 @@[m [mclass ClientEnforcementPolicyCustom extends BaseClientEnforcementPolicy {[m
      * @param clientSecretExpression[m
      * @param version will use BaseClientEnforcementPolicy version by default[m
      */[m
[31m-    ClientEnforcementPolicyCustom(List<PolicyPathApplication> policyPathApplications = null,[m
[31m-                                  String clientIdExpression = "#[attributes.headers['client_id']]",[m
[31m-                                  String clientSecretExpression = "#[attributes.headers['client_secret']]",[m
[31m-                                  String version = null) {[m
[32m+[m[32m    ClientEnforcementPolicyCustomAuth(List<PolicyPathApplication> policyPathApplications = null,[m
[32m+[m[32m                                      String version = null,[m
[32m+[m[32m                                      String clientIdExpression = "#[attributes.headers['client_id']]",[m
[32m+[m[32m                                      String clientSecretExpression = "#[attributes.headers['client_secret']]"[m
[32m+[m[32m                                      ) {[m
         super('customExpression',[m
               clientIdExpression,[m
               clientSecretExpression,[m
[1mdiff --git a/library/src/main/java/com/avioconsulting/mule/deployment/dsl/policies/ClientEnforcementPolicyCustomContext.groovy b/library/src/main/java/com/avioconsulting/mule/deployment/dsl/policies/ClientEnforcementPolicyCustomContext.groovy[m
[1mindex 0c3dde5..0593bd8 100644[m
[1m--- a/library/src/main/java/com/avioconsulting/mule/deployment/dsl/policies/ClientEnforcementPolicyCustomContext.groovy[m
[1m+++ b/library/src/main/java/com/avioconsulting/mule/deployment/dsl/policies/ClientEnforcementPolicyCustomContext.groovy[m
[36m@@ -1,19 +1,19 @@[m
 package com.avioconsulting.mule.deployment.dsl.policies[m
 [m
[31m-import com.avioconsulting.mule.deployment.api.models.policies.ClientEnforcementPolicyBasicAuth[m
[32m+[m[32mimport com.avioconsulting.mule.deployment.api.models.policies.ClientEnforcementPolicyCustomAuth[m
 import com.avioconsulting.mule.deployment.dsl.BaseContext[m
 [m
[31m-class ClientEnforcementPolicyBasicContext extends BaseContext {[m
[32m+[m[32mclass ClientEnforcementPolicyCustomContext extends BaseContext {[m
     String version[m
     private PathsContext paths = new PathsContext()[m
     private boolean pathsCalled = false[m
 [m
[31m-    ClientEnforcementPolicyBasicAuth createPolicyModel() {[m
[32m+[m[32m    ClientEnforcementPolicyCustomAuth createPolicyModel() {[m
         def pathListing = paths.createModel()[m
         if (pathsCalled && !pathListing.any()) {[m
             throw new Exception("You specified 'paths' but did not supply any 'path' declarations inside it. Either remove the paths declaration (policy applies to all resources) or declare one.")[m
         }[m
[31m-        new ClientEnforcementPolicyBasicAuth(pathListing,[m
[32m+[m[32m        new ClientEnforcementPolicyCustomAuth(pathListing,[m
                                              this.version)[m
     }[m
 [m
[1mdiff --git a/library/src/main/java/com/avioconsulting/mule/deployment/dsl/policies/PolicyListContext.groovy b/library/src/main/java/com/avioconsulting/mule/deployment/dsl/policies/PolicyListContext.groovy[m
[1mindex 9ce53df..ef3cc84 100644[m
[1m--- a/library/src/main/java/com/avioconsulting/mule/deployment/dsl/policies/PolicyListContext.groovy[m
[1m+++ b/library/src/main/java/com/avioconsulting/mule/deployment/dsl/policies/PolicyListContext.groovy[m
[36m@@ -25,6 +25,14 @@[m [mclass PolicyListContext {[m
         policies << policyContext.createPolicyModel()[m
     }[m
 [m
[32m+[m[32m    def clientEnforcementPolicyCustom(Closure closure = {}) {[m
[32m+[m[32m        def policyContext = new ClientEnforcementPolicyCustomContext()[m
[32m+[m[32m        closure.delegate = policyContext[m
[32m+[m[32m        closure.resolveStrategy = Closure.DELEGATE_FIRST[m
[32m+[m[32m        closure.call()[m
[32m+[m[32m        policies << policyContext.createPolicyModel()[m
[32m+[m[32m    }[m
[32m+[m
     def mulesoftPolicy(Closure closure) {[m
         def policyContext = new PolicyContext(Policy.getMulesoftGroupId())[m
         closure.delegate = policyContext[m
[1mdiff --git a/library/src/test/java/com/avioconsulting/mule/deployment/api/models/policies/ClientEnforcementPolicyTest.groovy b/library/src/test/java/com/avioconsulting/mule/deployment/api/models/policies/ClientEnforcementPolicyTest.groovy[m
[1mindex 104bb34..09b5218 100644[m
[1m--- a/library/src/test/java/com/avioconsulting/mule/deployment/api/models/policies/ClientEnforcementPolicyTest.groovy[m
[1m+++ b/library/src/test/java/com/avioconsulting/mule/deployment/api/models/policies/ClientEnforcementPolicyTest.groovy[m
[36m@@ -42,7 +42,7 @@[m [mclass ClientEnforcementPolicyTest {[m
         // arrange[m
 [m
         // act[m
[31m-        def model = new ClientEnforcementPolicyCustom()[m
[32m+[m[32m        def model = new ClientEnforcementPolicyCustomAuth()[m
 [m
         // assert[m
         assertThat model.groupId,[m
[1mdiff --git a/library/src/test/java/com/avioconsulting/mule/deployment/dsl/policies/PolicyContextTest.groovy b/library/src/test/java/com/avioconsulting/mule/deployment/dsl/policies/PolicyContextTest.groovy[m
[1mindex c6b4525..ededcc1 100644[m
[1m--- a/library/src/test/java/com/avioconsulting/mule/deployment/dsl/policies/PolicyContextTest.groovy[m
[1m+++ b/library/src/test/java/com/avioconsulting/mule/deployment/dsl/policies/PolicyContextTest.groovy[m
[36m@@ -515,6 +515,23 @@[m [mclass PolicyContextTest {[m
                    is(equalTo(new ClientEnforcementPolicyBasicAuth()))[m
     }[m
 [m
[32m+[m[32m    @Test[m
[32m+[m[32m    void client_enforcement_policy_custom_minimum() {[m
[32m+[m[32m        // arrange[m
[32m+[m[32m        def context = new ClientEnforcementPolicyCustomContext()[m
[32m+[m[32m        def closure = {[m
[32m+[m[32m        }[m
[32m+[m[32m        closure.delegate = context[m
[32m+[m[32m        closure.call()[m
[32m+[m
[32m+[m[32m        // act[m
[32m+[m[32m        def request = context.createPolicyModel()[m
[32m+[m
[32m+[m[32m        // assert[m
[32m+[m[32m        assertThat request,[m
[32m+[m[32m                is(equalTo(new ClientEnforcementPolicyCustomAuth()))[m
[32m+[m[32m    }[m
[32m+[m
     @Test[m
     void client_enforcement_policy_full() {[m
         // arrange[m
[1mdiff --git a/library/src/test/java/com/avioconsulting/mule/deployment/dsl/policies/PolicyListContextTest.groovy b/library/src/test/java/com/avioconsulting/mule/deployment/dsl/policies/PolicyListContextTest.groovy[m
[1mindex a553ee8..72cb0c4 100644[m
[1m--- a/library/src/test/java/com/avioconsulting/mule/deployment/dsl/policies/PolicyListContextTest.groovy[m
[1m+++ b/library/src/test/java/com/avioconsulting/mule/deployment/dsl/policies/PolicyListContextTest.groovy[m
[36m@@ -88,6 +88,33 @@[m [mclass PolicyListContextTest {[m
                    is(instanceOf(ClientEnforcementPolicyBasicAuth))[m
     }[m
 [m
[32m+[m[32m    @Test[m
[32m+[m[32m    void clientEnforcementPolicyCustom_with_details() {[m
[32m+[m[32m        // arrange[m
[32m+[m[32m        def context = new PolicyListContext()[m
[32m+[m[32m        def closure = {[m
[32m+[m[32m            policy {[m
[32m+[m[32m                assetId 'the-asset-id'[m
[32m+[m[32m                version '1.2.1'[m
[32m+[m[32m                config hello: 'there'[m
[32m+[m[32m            }[m
[32m+[m[32m            clientEnforcementPolicyCustom { version '1.4.1' }[m
[32m+[m[32m        }[m
[32m+[m[32m        closure.delegate = context[m
[32m+[m[32m        closure.call()[m
[32m+[m
[32m+[m[32m        // act[m
[32m+[m[32m        def result = context.createPolicyList()[m
[32m+[m
[32m+[m[32m        // assert[m
[32m+[m[32m        assertThat result.size(),[m
[32m+[m[32m                is(equalTo(2))[m
[32m+[m[32m        assertThat result[0],[m
[32m+[m[32m                is(instanceOf(Policy))[m
[32m+[m[32m        assertThat result[1],[m
[32m+[m[32m                is(instanceOf(ClientEnforcementPolicyCustomAuth))[m
[32m+[m[32m    }[m
[32m+[m
     @Test[m
     void no_policies_on_purpose() {[m
         // arrange[m
